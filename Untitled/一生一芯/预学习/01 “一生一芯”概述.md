- 欠缺独立解决问题的能力和意识

# PC发展史 

- Intel 4004(1971)
	- 4位寄存器和数据总线
	- 12位地址总线, 最多寻址4KB内存
	- 最高主频740KHz一般作为MCU使用, 无需配备操作系统
	- 多周期处理器
- Intel 8086(1971)
	- 16位寄存器和16位数据总线
	- 20位地址总线, 可寻址1MB内存
	- 主频5~10MHz
	- 变长指令集
	- 通过指令队列实现总线接口单元和执行单元的并发工作
-  [Intel 80186](https://en.wikipedia.org/wiki/Intel_80186)(1982)和[Intel 80286](https://en.wikipedia.org/wiki/Intel_80286)(1982)
- Windows1.x(1985)
	- 支持协同多任务
- Intel 80386(1985)
	- 32位的 x86 cpu
- Windows2.x(1987)
	- 抢占多任务
- Intel 80486(1989)
	- 主频16~100MHz, 但与80386相比, IPC提升了一倍([硬件手册](http://datasheets.chipdb.org/Intel/x86/486/manuals/27302101.PDF))
- Windows3.x(1990)
	- Windows 3.0新增功能:
	- Windows 3.1新增功能:
-  Intel Pentium(1993)
	- 主频60MHz~300MHz
-  [Windows 95](https://en.wikipedia.org/wiki/Windows_95)(1995)
-  [Intel Pentium Pro(奔腾Pro)](https://en.wikipedia.org/wiki/Pentium_Pro)(1995)


-  今天的计算机(工艺)
	-  摩尔定律还在继续 -> 暗硅(受限于功耗而需要关闭的晶体管)
	-  多核通常跑不了满频
- 今天的计算机(微结构)
	- 处理器空前复杂
	-   每个新功能都要与很多旧功能交互
	- 各种漏洞: 2018年的[熔断和幽灵](https://meltdownattack.com/)
		- Intel一开始发布的补丁会导致死机, [被Linus喷是垃圾](https://thehackernews.com/2018/01/intel-meltdown-spectre-patch.html)
		- Intel资深工程师也没法一下子想明白处理器的所有细节
- 今天的计算机(操作系统)
	- Linux 4.17(2018年4月发布)[删除了过时处理器的代码](https://fossbytes.com/linux-kernel-dropping-support-older-cpus-reducing-size/)
	-   减少了50万行代码
	-   但还有2030万行
	- [Linux内核](https://en.wikipedia.org/wiki/Linux_kernel)包含海量的模块, 交互关系非常复杂

- 推荐: [A New Golden Age for Computer Architecture](https://cacm.acm.org/magazines/2019/2/234352-a-new-golden-age-for-computer-architecture/fulltext)


# 启发

- 更重要的两个观念
	- 硬件需要软件的支持才能发挥作用(80386发布时没有32位OS)
		- 狭义的处理器芯片设计: **RTL开发**
		- 广义的处理器芯片设计: **计算机系统软硬件协同设计**
			- “一生一芯”讨论的范畴
	- 复杂系统是迭代演进的(多周期->流水线->超标量->乱序执行)
		- 推荐阅读: [《系统设计黄金法则：简单之美》](https://blog.sciencenet.cn/blog-414166-562616.html), 包云岗
			- KISS法则 - Keep It Simple, Stupid

# 为什么学 “一生一芯”?

-  “一生一芯”的两种诠释
	- 每一位学生带着自己设计的芯片毕业
	- 拿到自己一生中的第一颗芯片
- 重要的是通过我们设置的训练让你变强
	- 全方位, 全身心, 肉眼可见地变强
	- 锻炼专业人士所需的专业素质
- 回答如下问题
	- 应该如何编写C程序来测试?
	- 测试可能会遇到什么问题?
	- 如何编写一个打印Hello的C程序放到你的CPU上运行?
	- 你写的流水线CPU具体在哪里地方比单周期CPU快多少?
	- CPU仿真过了100000000周期后出错, 如何快速调试?
- **按计算机发展史的顺序设计处理器**
	- 树立全面的软硬件全系统认识
	-   理解科学的安排规划和优化方法
	-   掌握正确的工具技能高效解决实际的工程问题
- 熟练工 vs. 专业人士
	- 熟练工: 可以很好地完成指定任务, 保证项目流程往前推进
	- 专业人士: 具备独立解决未知问题的专业素质
		-  专业技能: 正确理解专业知识点, 并具备全局系统观
		-   专业方法: 知道如何找到相关的代码/资料/工具
		-   专业世界观: 明白做什么事情是正确/高效/科学的, 如何分解复杂任务
- 解决上百个 “新问题”, 锻炼出专业世界观

# 怎么学 “一生一芯”?

- 真正的处理器是一个复杂的系统
	- - 教科书上的处理器
	- 一生一芯”中的处理器
		-  [果壳](https://github.com/oscpu/NutShell) = ~100条指令+流水线+中断异常+cache+MMU+AXI总线
	- 科研原型系统的高性能处理器
		- [香山](https://github.com/OpenXiangShan/XiangShan) = ~250条指令+8取指+6译码+17个FU+192项ROB+
	- 量产的工业级高性能处理器
		- [M1](https://www.anandtech.com/show/16226/apple-silicon-m1-a14-deep-dive/2) = ARMv8指令集+8译码+17个FU+~630项ROB+黑科技+
- 仅仅会看波形是不够的
	- 跑超级玛丽, 100,000周期后assert失败
	-  跑仙剑, 10,000,000周期后图形不正确
	-  启动Linux Debian跑gcc, 1,000,000,000周期后段错误
	- 波形中寻找错误不可取
	- 教科书/大作业并不会教你如何应对这些问题
		- 做小玩具, 方法再怎么简陋, 也能做出来
- 复杂系统需要用科学的方法来构建和维护
	- 了解软硬件全系统的每一处细节, 为调bug提供大方向
	- 先完成后完美, 体会每一项技术对系统带来的性能提升
	- 构建正确的工具, 提升开发和验证效率
- **所以 “一生一芯”不仅仅是写RTL**
	- 用盖楼比喻, 完整的处理器芯片设计包含
		-  体系结构设计 -> 画图纸
		-   RTL设计 -> 施工
		-   辅助工具搭建 -> 打磨施工工具
		-   测试 -> 建筑验收
		-   程序和系统软件开发 -> 建筑投入使用
		-   SoC设计 -> 外围设施
		-   后端物理设计
- “一生一芯”希望培养的是建筑专家
	- 游戏如何在软硬件的协同支持下运行? (先完成)
	- 要提升游戏体验, 应该如何进行全系统的优化? (后完美）
-    一生一芯”不是传统意义上的课程大作业
    -   课堂和讲义不会告诉你所有细节
    -   你需要主动从相关资料/代码中找到重要的信息
-   你遇到的所有问题(除了框架代码自身错误), 都是在锻炼你的能力
    -   老师助教不会手把手帮你解决所有问题
    -   独立解决这些问题, 是对你最大的训练


-  专业世界观1 - 学术诚信
	- [MIT对学术诚信的诠释](http://integrity.mit.edu/), 尤其是[关于写代码的学术诚信](http://integrity.mit.edu/handbook/writing-code)
		-   独立完成学习任务
		-   在允许的范围内参考相关资料
		-   不参考别人的代码, 不分享自己的代码
	意义: 让你接受预期的训练, 锻炼出预期的能力
	
	这是需要大家发自内心去认可和执行的: 我们很难约束大家

- 专业世界观2 - 大佬三连


STFW - Search The Friendly Web

-   只要我用的工具是大众的, 我几乎不可能是世界上第一个遇到问题的人
-   网上一定有人遇到过相同/类似问题, 我应该搜一下看看他们怎么解决

RTFM - Read The Friendly Manual

-   只要我用的工具是大众的, 应该有手册记录这个工具的所有细节
-   如果我想了解它的某个问题, 我应该去搜索手册的描述

RTFSC - Read The Friendly Source Code

-   只要我获得了项目代码, 理论上我就可以知晓它的一切行为
-   如果我想了解它具体是如何工作的, 我应该去读一下(关键)代码

如果你在提问时收到了这些回复, 其背后的含义是:
	1.  你想要的答案很容易找到, 你很应该自己去获取
	2.  相比于我直接告诉你答案, 你自己获取答案能学到更多


- 专业世界观3 - 科学提问
	-   提问能反映出你的学习态度: 主动尝试 vs. 被动依赖

	- 不是所有问题都值得问

	- 鼓励的提问 vs. 不应该的提问
		- 属于训练环节, 但经历过合理尝试还无法解决的问题: [提问模板](https://ysyx.oscc.cc/docs/misc/ask.html)
		
  
  # 总结
  
  - “一生一芯”不仅仅是训练大家编写RTL

-   而是用全新的方法和流程, 按计算机发展史的顺序设计处理器
    -   树立全面的软硬件全系统认识
    -   理解科学的安排规划和优化方法
    -   掌握正确的工具技能解决实际的工程问题